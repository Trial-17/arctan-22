"object"!=typeof JSON&&(JSON={}),function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var r=meta[e];return"string"==typeof r?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,r){var t,i,n,a,o,s=gap,c=r[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(r,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(c)){for(a=c.length,t=0;t<a;t+=1)o[t]=str(t,c)||"null";return n=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,n}if(rep&&"object"==typeof rep)for(a=rep.length,t=0;t<a;t+=1)"string"==typeof rep[t]&&(n=str(i=rep[t],c))&&o.push(quote(i)+(gap?": ":":")+n);else for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(n=str(i,c))&&o.push(quote(i)+(gap?": ":":")+n);return n=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,n}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,r,t){var i;if(gap="",indent="","number"==typeof t)for(i=0;i<t;i+=1)indent+=" ";else"string"==typeof t&&(indent=t);if(rep=r,r&&"function"!=typeof r&&("object"!=typeof r||"number"!=typeof r.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,r){var t,i,n=e[r];if(n&&"object"==typeof n)for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(void 0!==(i=walk(n,t))?n[t]=i:delete n[t]);return reviver.call(e,r,n)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),$._MYFUNCTIONS={},$._MYFUNCTIONS.createPremiereCopilotTempFolder=function(){var e=Folder.myDocuments.fsName+"/Adobe/Premiere Pro/Premiere Copilot/temp",r=new Folder(e);if(!r.exists&&!r.create())return alert("Erreur : impossible de cr√©er le dossier : "+e),null;return r},$._MYFUNCTIONS.podcast_getTrackNumber=function(){var e=app.project.activeSequence;if(e){for(var r=0,t=0,i=0;i<e.videoTracks.numTracks;i++){e.videoTracks[i].clips.numItems>0&&r++}for(var n=0;n<e.audioTracks.numTracks;n++){e.audioTracks[n].clips.numItems>0&&t++}return $.writeln("Nombre de pistes vid√©o avec √©l√©ments : "+r),$.writeln("Nombre de pistes audio avec √©l√©ments : "+t),[r,t]}$.writeln("Aucune s√©quence active trouv√©e.")},$._MYFUNCTIONS.exportAudioTracksDirect=function(){for(var e=$.os.toLowerCase(),r=app.project.activeSequence,t=[],i=0;i<r.audioTracks.numTracks;i++){if(r.audioTracks[i].clips.numItems>0){for(var n=0;n<r.audioTracks.numTracks;n++)n===i?r.audioTracks[n].setMute(0):r.audioTracks[n].setMute(1);var a=$._MYFUNCTIONS.createPremiereCopilotTempFolder();if(-1!==e.indexOf("mac"))var o="/Library/Application Support/Adobe/CEP/extensions/PremiereGPTBeta/js/libs/render/Audio_ForJumpCuts.epr",s=new File(a.fsName+"/Track "+(i+1)+".mp3");else if(-1!==e.indexOf("windows"))o=new File("C:/Program Files/Common Files/Adobe/CEP/extensions/PremiereGPTBeta/js/libs/render/Audio_ForJumpCuts.epr").fsName,s=new File(a.fsName+"/Track "+(i+1)+".mp3");r.exportAsMediaDirect(s.fsName,o,1);t.push(s.fsName)}}for(i=0;i<r.audioTracks.numTracks;i++)r.audioTracks[i].setMute(0);return JSON.stringify(t)},$._MYFUNCTIONS.supprimerClipsDesactives_PODCAST=function(){for(var e=app.project.activeSequence,r=[],t=0;t<e.videoTracks.numTracks;t++)for(var i=e.videoTracks[t],n=0;n<i.clips.numItems;n++){var a=i.clips[n];a.disabled&&r.push(a)}if(0!==r.length){r.sort(function(e,r){return r.start.seconds-e.start.seconds});for(t=0;t<r.length;t++)r[t].remove(!1,!1)}else alert("No disabled clips found.")},$._MYFUNCTIONS.perform_cut=function(e){e=JSON.parse(e),app.enableQE();for(var r=app.project.activeSequence,t=[],i=0;i<r.videoTracks.numTracks;i++){if((f=r.videoTracks[i])&&f.clips.numItems>0)for(var n=0;n<f.clips.numItems;n++){(v=f.clips[n]).disabled=1}}if(r){var a=qe.project.getActiveSequence();if(a)for(var o=1;o<e.length;o++){var s=e[o],c=s.time,u=Math.floor(254016e6*c),l=new Time;l.ticks=u.toString(),r.setPlayerPosition(l.ticks);var p=parseInt(l.ticks);if(0!==c){for(var m=0;m<a.numVideoTracks;m++){(f=a.getVideoTrackAt(m))&&f.razor(a.CTI.timecode)}for(n=(f=r.videoTracks[s.camera]).clips.numItems-1;n>=0;n--){v=f.clips[n],T=(d=parseInt(v.start.ticks))+parseInt(v.duration.ticks);if(d<=p&&p<T){t.push(v);break}}}else for(i=0;i<r.videoTracks.numTracks;i++){var f;if((f=r.videoTracks[i])&&f.clips.numItems>0)for(var n=0;n<f.clips.numItems;n++){var d,v=f.clips[n],T=(d=parseInt(v.start.ticks))+parseInt(v.duration.ticks);d<=p&&p<T&&i!==s.camera&&t.push(v)}}}}for(i=0;i<t.length;i++){(v=t[i]).disabled=0}},$._MYFUNCTIONS.test=function(){alert("Le test JSX fonctionne")},$._MYFUNCTIONS.backupActiveSequence=function(){var e=app.project.rootItem,r="Copilot Backup",t=null;function i(e){return e<10?"0"+e:e}for(var n=0;n<e.children.numItems;n++){if(2===(l=e.children[n]).type&&l.name===r){t=l;break}}null===t&&(t=e.createBin(r));var a=app.project.activeSequence;if(!a)return!1;var o=a.sequenceID,s=a.name,c=e.children.numItems,u=(a.clone(),null);for(n=c;n<e.children.numItems;n++){var l;if(1===(l=e.children[n]).type){u=l;break}}if(u){var p=new Date,m=p.getFullYear()+"-"+i(p.getMonth()+1)+"-"+i(p.getDate())+" "+i(p.getHours())+":"+i(p.getMinutes())+":"+i(p.getSeconds()),f=s,d=/ Copilot Backup \d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/;d.test(s)&&(f=s.replace(d,""));var v=f+" Copilot Backup "+m;u.name=v,u.moveBin(t)}for(n=0;n<app.project.sequences.length;n++){var T=app.project.sequences[n];if(T.sequenceID===o){app.project.activeSequence=T;break}}$.sleep(1)},$._MYFUNCTIONS.getImportPath=function(){var e=app.project.rootItem,r=[".mp4",".mov",".avi"],t=[];return function e(i){for(var n=0;n<i.children.numItems;n++){var a=i.children[n];if(2===a.type)e(a);else if(1===a.type){var o=a.getMediaPath();if(o&&"string"==typeof o)for(var s=o.toLowerCase(),c=0;c<r.length;c++)if(-1!==s.indexOf(r[c])){t.push(o);break}}}}(e),JSON.stringify(t)},$._MYFUNCTIONS.importIntoDeepResearch=function(e){for(var r="DeepResearch Import",t=app.project.rootItem,i=null,n=0;n<t.children.numItems;n++){var a=t.children[n];if(a&&a.name===r&&a.type===ProjectItemType.BIN){i=a;break}}null===i&&(i=t.createBin(r));for(var o=JSON.parse(e),s=[],c=0;c<o.length;c++){var u=o[c],l=new File(u);if(l.exists){var p=i.children.numItems;app.project.importFiles([l.fsName],!1,i,!1);var m=i.children.numItems;if(m>p){var f=i.children[m-1];s.push(f)}}else $.writeln("Fichier introuvable : "+u)}if(s.length>0&&app.project.activeSequence){for(var d=app.project.activeSequence.videoTracks[0],v=0,T=0;T<d.clips.numItems;T++){var I=d.clips[T],N=I.start.seconds+I.duration.seconds;N>v&&(v=N)}for(var k=0;k<s.length;k++){var g=s[k];g&&g.type===ProjectItemType.CLIP&&(d.insertClip(g,v),v+=g.getOutPoint().seconds)}}else Alert("Aucune s√©quence active ou aucun rush import√©.")},$._MYFUNCTIONS.openFinderAndGetPath=function(){var e=File.openDialog("Select an image","*.jpg;*.jpeg;*.png",!1);if(null!==e){var r=e.fsName,t=r.toLowerCase().split(".").pop();return"jpg"!==t&&"jpeg"!==t&&"png"!==t?"undefined":r}return"undefined"},$._MYFUNCTIONS.exportCurrentFrameToTempPNG=function(){app.enableQE();var e=qe.project.getActiveSequence(),r=e.CTI.timecode,t=r.replace(/:|;/gi,"_"),i=Folder.myDocuments,n=new Folder(i.fullName+"/Adobe/Premiere Pro/Premiere Copilot/temp");n.exists||(n.create(),$.writeln("üìÅ Created folder: "+n.fsName));var a=e.name+"__"+t,o=$.os.toLowerCase();if(-1!==o.indexOf("mac"))var s=n.fsName+"/"+a;else if(-1!==o.indexOf("windows"))s=n.fsName+"''"+a;return e.exportFramePNG(r,s),s+".png"},$._MYFUNCTIONS.importVideoToVideoGenerationBin=function(e){if(e&&File(e).exists){for(var r=app.project.rootItem,t="Video Generation",i=null,n=0;n<r.children.numItems;n++){var a=r.children[n];if(a&&a.type===ProjectItemType.BIN&&a.name===t){i=a;break}}i||(i=r.createBin(t),$.writeln("üìÅ Bin cr√©√© : "+t));var o=app.project.importFiles([e],!1,i,!1);o&&o[0]?$.writeln("‚úÖ Fichier import√© : "+o[0].name+" ‚Üí "+t):$.writeln("‚ùå √âchec de l'importation.")}else $.writeln("‚ùå Fichier introuvable : "+e)},$._MYFUNCTIONS.getAllBins=function(){var e=[];function r(t){if(t.type===ProjectItemType.BIN){e.push(t.name);for(var i=0;i<t.children.numItems;i++)r(t.children[i])}}for(var t=app.project.rootItem.children,i=0;i<t.numItems;i++)r(t[i]);return JSON.stringify(e)},$._MYFUNCTIONS.getAllSequences=function(){for(var e=app.project.sequences,r=e.numSequences,t=[],i=0;i<r;i++)t.push(e[i].name);return JSON.stringify(t)},$._MYFUNCTIONS.exportFullAudioFromSequence=function(){var e=Folder.myDocuments.fsName,r=new Folder(e+"/Adobe/Premiere Pro/Premiere Copilot/temp"),t=app.project.activeSequence,i=$.os.toLowerCase();var n,a,o=(n=new Date,a=function(e){return(e<10?"0":"")+e},n.getFullYear().toString()+a(n.getMonth()+1)+a(n.getDate())+"_"+a(n.getHours())+a(n.getMinutes())+a(n.getSeconds()));if(-1!==i.indexOf("mac"))var s="/Library/Application Support/Adobe/CEP/extensions/PremiereGPTBeta/js/libs/render/Audio_ForDemucs.epr",c=r.fsName+"/"+t.name+"_"+o+".wav";else if(-1!==i.indexOf("windows")){s=new File("C:/Program Files (x86)/Common Files/Adobe/CEP/extensions/PremiereGPTBeta/js/libs/render/Audio_ForDemucs.epr").fsName;c=File(r.absoluteURI+"/"+t.name+"_"+o+".wav").fsName}return t.exportAsMediaDirect(c,s,1)?($.writeln("Export audio r√©ussi vers : "+c),c):(alert("Erreur lors de l'export audio de la s√©quence : "+t.name),null)},$._MYFUNCTIONS.getRushPathsFromBin=function(e){var r=[];function t(e,r){if(e.type===ProjectItemType.BIN&&e.name===r)return e;if(e.type===ProjectItemType.BIN)for(var i=0;i<e.children.numItems;i++){var n=t(e.children[i],r);if(n)return n}return null}for(var i=app.project.rootItem.children,n=null,a=0;a<i.numItems&&!(n=t(i[a],e));a++);return n?(function e(t){if(t.type===ProjectItemType.CLIP||t.type===ProjectItemType.FILE){var i=t.getMediaPath();i&&r.push(i)}else if(t.type===ProjectItemType.BIN)for(var n=0;n<t.children.numItems;n++)e(t.children[n])}(n),JSON.stringify(r)):(alert("Aucun dossier nomm√© '"+e+"' trouv√©."),[])},$._MYFUNCTIONS.importAllWavToDemixed=function(e){for(var r=app.project,t=r.rootItem,i=null,n=0;n<t.children.numItems;n++)if(t.children[n].type===ProjectItemType.BIN&&"demixed"===t.children[n].name){i=t.children[n];break}i||(i=t.createBin("demixed"));var a=new Folder(e);if(!a.exists)return[];var o=a.getFiles("*.wav");if(0===o.length)return[];for(var s=[],c=0;c<o.length;c++)s.push(o[c].fsName);for(var u=[],l=0;l<i.children.numItems;l++){var p=i.children[l];u.push(p.nodeId)}r.importFiles(s,!0,i,!1);for(var m=[],f=0;f<i.children.numItems;f++){for(var d=i.children[f],v=!0,T=0;T<u.length;T++)if(d.nodeId===u[T]){v=!1;break}v&&m.push(d)}return m},$._MYFUNCTIONS.ensure_minimum_empty_tracks=function(e,r,t){if("number"!=typeof e||e<1)$.writeln("Please provide a valid number of empty tracks (>= 1).");else if(r||t){app.enableQE();var i=qe.project.getActiveSequence();if(i){if(r){for(var n=i.numVideoTracks,a=0,o=n-1;o>=0;o--){if(0!==app.project.activeSequence.videoTracks[o].clips.length)break;a++}var s=e-a;s>0?(i.addTracks(s,n,0),$.writeln(s+" empty video track(s) added to meet the requirement.")):$.writeln("No video tracks added. The sequence already has "+a+" empty video track(s).")}if(t){var c=i.numAudioTracks,u=0;for(o=c-1;o>=0;o--){if(0!==app.project.activeSequence.audioTracks[o].clips.length)break;u++}var l=e-u;l>0?(i.addTracks(0,0,l,0,c),$.writeln(l+" empty audio track(s) added to meet the requirement.")):$.writeln("No audio tracks added. The sequence already has "+u+" empty audio track(s).")}}else alert("No active sequence found!")}else $.writeln("Please enable either 'forVideo' or 'forAudio' or both.")},$._MYFUNCTIONS.insertWavsOnePerEmptyTrack=function(e){var r=app.project.activeSequence;if(r){for(var t=r.audioTracks.numTracks,i=0,n=0;n<t&&!(i>=e.length);n++){var a=r.audioTracks[n];0===a.clips.numItems&&(a.insertClip(e[i],0),i++)}i<e.length&&alert("‚ö†Ô∏è "+i+" clip(s) ins√©r√©(s). "+(e.length-i)+" non ins√©r√©(s) faute de pistes vides.")}else alert("Aucune s√©quence active.")},$._MYFUNCTIONS.addMarkersOnFirstAudioClipAtTimes=function(e,r){var t=app.project.activeSequence;if(t){var i=t.audioTracks[0];if(i&&0!==i.clips.numItems)for(var n=0;n<e.length;n++){var a=e[n];(new Time).seconds=a;for(var o=null,s=0;s<i.clips.numItems;s++){var c=i.clips[s],u=c.start.seconds,l=c.end.seconds;if(a>=u&&a<=l){o=c;break}}if(o){var p=o.projectItem.getMarkers();if(p){var m=new Time,f=o.inPoint.seconds,d=a-o.start.seconds;m.seconds=f+d;var v=p.createMarker(m.seconds);v.name="Marker at "+a.toFixed(2)+"s",v.comments="Ajout√© par script",v.setColorByIndex(r,0)}}}else alert("Aucun clip dans la premi√®re piste audio.")}else alert("Aucune s√©quence active.")},$._MYFUNCTIONS.addSequenceMarker=function(e,r,t,i){var n=app.project.activeSequence;if(n)if(r<=e)alert("Le temps de fin doit √™tre sup√©rieur au d√©but.");else{var a=n.markers.createMarker(e);a.name=t,a.end=r,a.setColorByIndex(i,0)}else alert("Aucune s√©quence active.")},$._MYFUNCTIONS.apply_music_analysis=function(e,r,t){$._MYFUNCTIONS.addMarkersOnFirstAudioClipAtTimes(r,5),$._MYFUNCTIONS.addMarkersOnFirstAudioClipAtTimes(t,6);var i=$._MYFUNCTIONS.importAllWavToDemixed(e);i.length>0&&($._MYFUNCTIONS.ensure_minimum_empty_tracks(i.length,!1,!0),$._MYFUNCTIONS.insertWavsOnePerEmptyTrack(i))},$._MYFUNCTIONS.movePlayheadToSeconds=function(e){if("number"!=typeof e)throw new Error("Expected a number in seconds.");var r=new Time;r.seconds=e,app.project.activeSequence.setPlayerPosition(r.ticks)},$._MYFUNCTIONS.razorAllTracksAtPlayhead=function(){var e=qe.project.getActiveSequence();if(e){var r=e.CTI.timecode;if(r){for(var t=0;t<e.numVideoTracks;t++){var i=e.getVideoTrackAt(t);i&&i.razor(r)}for(var n=0;n<e.numAudioTracks;n++){var a=e.getAudioTrackAt(n);a&&a.razor(r)}$.writeln("Razor at: "+r)}else alert("Playhead position not available.")}else alert("No active sequence found.")},$._MYFUNCTIONS.deleteSelectedTrackItem=function(){var e=app.project.activeSequence;if(e){for(var r=0;r<e.videoTracks.numTracks;r++)for(var t=e.videoTracks[r],i=0;i<t.clips.numItems;i++){(a=t.clips[i]).isSelected()&&(a.remove(!1,!1),$.writeln("Deleted selected VIDEO clip: "+a.name))}for(var n=0;n<e.audioTracks.numTracks;n++)for(t=e.audioTracks[n],i=0;i<t.clips.numItems;i++){var a;(a=t.clips[i]).isSelected()&&(a.remove(!1,!1),$.writeln("Deleted selected AUDIO clip: "+a.name))}$.writeln("No selected clip found to delete.")}else alert("No active sequence.")},$._MYFUNCTIONS.selectAllTrackItemsAtPlayhead=function(){var e=app.project.activeSequence;if(e){for(var r=e.getPlayerPosition(),t=Number(r.ticks),i=0;i<e.videoTracks.numTracks;i++)for(var n=e.videoTracks[i],a=0;a<n.clips.numItems;a++)n.clips[a].setSelected(!1,!1);for(var o=0;o<e.audioTracks.numTracks;o++){var s=e.audioTracks[o];for(a=0;a<s.clips.numItems;a++)s.clips[a].setSelected(!1,!1)}var c=0;for(i=0;i<e.videoTracks.numTracks;i++){var u=e.videoTracks[i];for(a=0;a<u.clips.numItems;a++){var l=u.clips[a],p=Number(l.start.ticks),m=Number(l.end.ticks);p<=t&&t<m&&(l.setSelected(!0,!0),c++)}}for(o=0;o<e.audioTracks.numTracks;o++)for(u=e.audioTracks[o],a=0;a<u.clips.numItems;a++){l=u.clips[a],p=Number(l.start.ticks),m=Number(l.end.ticks);p<=t&&t<m&&(l.setSelected(!0,!0),c++)}$.writeln("‚úÖ Selected "+c+" clip(s) under playhead.")}else alert("No active sequence.")},$._MYFUNCTIONS.closeAllGaps=function(){var e=app.project.activeSequence;if(e){for(var r=254016e6,t=0;t<e.videoTracks.numTracks;t++)n(e.videoTracks[t]);for(var i=0;i<e.audioTracks.numTracks;i++)n(e.audioTracks[i]);$.writeln("‚úÖ All gaps closed.")}else alert("No active sequence.");function n(e){for(var t=null,i=0;i<e.clips.numItems;i++){var n=e.clips[i],a=Number(n.start.ticks);if(0===i&&a>0){var o=a/r;n.move(-o),$.writeln("‚è™ Moved first clip ("+n.name+") to start (gap: "+o.toFixed(3)+"s)")}else if(null!==t&&a>t){o=(a-t)/r;n.move(-o),$.writeln("üí• Moved clip ("+n.name+") left by "+o.toFixed(3)+"s")}t=Number(n.end.ticks)}}},$._MYFUNCTIONS.perform_cut_transcription=function(e){app.enableQE();for(var r=0;r<e.length;r++){var t=e[r],i=t[0],n=t[1];$._MYFUNCTIONS.movePlayheadToSeconds(i),$.writeln("Moved to in time: "+i),$._MYFUNCTIONS.razorAllTracksAtPlayhead(),$._MYFUNCTIONS.movePlayheadToSeconds(n),$.writeln("Moved to out time: "+n),$._MYFUNCTIONS.razorAllTracksAtPlayhead(),$._MYFUNCTIONS.movePlayheadToSeconds(i),$._MYFUNCTIONS.selectAllTrackItemsAtPlayhead(),$._MYFUNCTIONS.deleteSelectedTrackItem()}$._MYFUNCTIONS.closeAllGaps()},$._MYFUNCTIONS.importSRTAsCaption=function(e){if(app.project.activeSequence)if(e&&".srt"===e.slice(-4).toLowerCase()){for(var r=app.project.rootItem,t=null,i=0;i<r.children.numItems;i++){var n=r.children[i];if(n&&"Copilot Transcription"===n.name&&n.type===ProjectItemType.BIN){t=n;break}}t||(t=r.createBin("Copilot Transcription"));var a=app.project.importFiles([e],!1,t,!1);if(a&&0!==a.length)a[0];else alert("‚ùå Failed to import SRT file into project.")}else alert("Please provide a valid .srt file path.");else alert("No active sequence.")},$._MYFUNCTIONS.resetInOutPointsForBin=function(e){var r=function e(r,t){for(var i=0;i<r.children.numItems;i++){var n=r.children[i];if(n.type===ProjectItemType.BIN){if(n.name===t)return n;var a=e(n,t);if(a)return a}}return null}(app.project.rootItem,e);r&&function e(r){for(var t=0;t<r.children.numItems;t++){var i=r.children[t];i.type===ProjectItemType.CLIP?(i.clearInPoint(),i.clearOutPoint()):i.type===ProjectItemType.BIN&&e(i)}}(r)},$._MYFUNCTIONS.getFirstFreeTracks=function(e,r){$._MYFUNCTIONS.ensure_minimum_empty_tracks(1,!1,!0),$._MYFUNCTIONS.ensure_minimum_empty_tracks(1,!0,!1);var t=app.project.activeSequence,i=o(e),n=o(r);return{videoTrackIndex:a(t.videoTracks,i,n),audioTrackIndex:a(t.audioTracks,i,n)};function a(e,r,t){for(var i=0;i<e.numTracks;i++){for(var n=e[i],a=!0,o=0;o<n.clips.numItems;o++){var s=n.clips[o],c=parseInt(s.start.ticks);if(!(parseInt(s.end.ticks)<=r||c>=t)){a=!1;break}}if(a)return i}return-1}function o(e){return Math.floor(254016e6*e)}},$._MYFUNCTIONS.findProjectItemByPath=function(e){return function r(t){for(var i=0;i<t.children.numItems;i++){var n=t.children[i];if(n.type===ProjectItemType.BIN){var a=r(n);if(a)return a}else if(n.getMediaPath&&n.getMediaPath()===e)return n}return null}(app.project.rootItem)},$._MYFUNCTIONS.insertClipsFromData=function(e){if(app.project.activeSequence)for(var r=app.project.activeSequence,t=0;t<e.length;t++){var i=e[t],n=e[t+1],a=n?n.time-i.time:2,o=$._MYFUNCTIONS.findProjectItemByPath(i.clip_file);if(o){var s=o.getInPoint().seconds,c=o.getOutPoint().seconds,u=s+(c-s)/2,l=u-a/2;l=Math.max(s,l);var p=u+a/2+.5;p=Math.min(c,p),o.setInPoint(l,4),o.setOutPoint(p,4);var m=$._MYFUNCTIONS.getFirstFreeTracks(i.time,n.time);r.overwriteClip(o,i.time,0,m.audioTrackIndex)}else $.writeln("‚ö†Ô∏è Clip non trouv√© : "+i.clip_file)}else $.writeln("‚ùå Aucune s√©quence active.")},$._MYFUNCTIONS.insertClipsFromData_SPEAKER=function(e){if(app.project.activeSequence)for(var r=app.project.activeSequence,t=0;t<e.length;t++){var i=e[t],n=$._MYFUNCTIONS.findProjectItemByPath(i.clip_file);if(n){var a=n.getInPoint().seconds,o=n.getOutPoint().seconds,s=a+(o-a)/2,c=i.timeOUT-i.timeIN,u=s-c/2;u=Math.max(a,u);var l=s+c/2;(l=Math.min(o,l))-u<c&&(u=l-c)<a&&(u=a,l=a+c),n.setInPoint(u,4),n.setOutPoint(l,4);var p=$._MYFUNCTIONS.getFirstFreeTracks(i.timeIN,i.timeOUT);r.overwriteClip(n,i.timeIN,p.videoTrackIndex,p.audioTrackIndex)}else $.writeln("‚ö†Ô∏è Clip non trouv√© : "+i.clip_file)}else $.writeln("‚ùå Aucune s√©quence active.")},$._MYFUNCTIONS.captureSelectedTrackItemMarkers=function(){var e=app.project.activeSequence;if(!e)return alert("No active sequence found."),[];for(var r=[],t=e.getSelection(),i=0;i<t.length;i++){var n=t[i];if(n.projectItem){var a=n.projectItem.getMarkers();if(a)for(var o=a.getFirstMarker();o;){var s=parseInt(o.start.ticks)-parseInt(n.inPoint.ticks),c=parseInt(n.start.ticks)+s,u=new Time;u.ticks=c.toString(),e.setPlayerPosition(u.ticks);var l=e.getPlayerPosition().seconds;r.push(l),o=a.getNextMarker(o)}}}r.sort(function(e,r){return e-r});for(var p=[],m={},f=0;f<r.length;f++){var d=r[f],v=d.toFixed(4);m[v]||(p.push(d),m[v]=!0)}return p},$._MYFUNCTIONS.fast_edit=function(){var e=$._MYFUNCTIONS.captureSelectedTrackItemMarkers();if(e&&0!==e.length){var r=app.project.activeSequence;if(r){for(var t=[],i=0;i<r.videoTracks.numTracks;i++)for(var n=r.videoTracks[i],a=0;a<n.clips.numItems;a++){(u=n.clips[a]).isSelected()&&t.push({clip:u,videoTrackIndex:i,start:u.start.seconds})}if(t.sort(function(e,r){return e.start-r.start}),0!==t.length)for(var o=e[0],s=0;s<t.length;s++){for(var c=t[s],u=c.clip,l=c.videoTrackIndex,p=u.projectItem,m=u.inPoint.seconds,f=o+(u.outPoint.seconds-m),d=null,v=null,T=0;T<e.length;T++){var I=e[T];if(!(I<f)){k=Math.min(e.length-1,T),v=e[k];break}d=I}d||(d=f),(d===o||Math.abs(f-d)>Math.abs(f-v))&&(d=v);var N=d-o,g=m,h=g+N;function S(e,r){return Math.floor(e/r)*r}p.setInPoint(g,4),p.setOutPoint(h,4),u.remove(0,1),o=S(o,r.getSettings().videoFrameRate.seconds),r.overwriteClip(p,o,l,0),o+=N}else alert("‚ùå Aucun clip s√©lectionn√©.")}else alert("‚ùå Aucune s√©quence active.")}else alert("‚ùå Liste de marqueurs vide.")},$._MYFUNCTIONS.exportCurrentFrameToHighResPNG=function(){app.enableQE();var e=qe.project.getActiveSequence();if(!e)return $.writeln("‚ùå No active sequence."),null;var r=e.CTI.timecode,t=r.replace(/:|;/gi,"_"),i=Folder.myDocuments,n=new Folder(i.fullName+"/Adobe/Premiere Pro/Premiere Copilot/image_generation");n.exists||(n.create(),$.writeln("üìÅ Created folder: "+n.fsName));var a=e.name+"__"+t,o=$.os.toLowerCase();if(-1!==o.indexOf("mac"))var s=n.fsName+"/"+a;else if(-1!==o.indexOf("windows"))s=n.fsName+"''"+a;return e.exportFramePNG(r,s),$.writeln("Exported PNG frame to: "+s),s+".png"},$._MYFUNCTIONS.importImageToImageGenerationBin=function(e){if(e&&new File(e).exists){for(var r=app.project,t=r.rootItem,i=null,n=0;n<t.children.numItems;n++){var a=t.children[n];if(a&&a.type===ProjectItemType.BIN&&"Image Generation"===a.name){i=a;break}}i||(i=t.createBin("Image Generation"));r.importFiles([e],!1,i,!1)}},$._MYFUNCTIONS.isTrackClearAtTime=function(e,r,t){if(!e)return!1;var i=e.clips;if(0===i.numItems)return!0;for(var n=0;n<i.numItems;n++){var a=i[n];if(a.start.seconds<t&&a.end.seconds>r)return!1}return!0},$._MYFUNCTIONS.importImageToImageGenerationBin_V2=function(e){if($._MYFUNCTIONS.ensure_minimum_empty_tracks(1,!1,!0),$._MYFUNCTIONS.ensure_minimum_empty_tracks(1,!0,!1),!e||!new File(e).exists)return null;for(var r=app.project,t=r.rootItem,i=null,n=0;n<t.children.numItems;n++){var a=t.children[n];if(a&&a.type===ProjectItemType.BIN&&"Image Generation"===a.name){i=a;break}}i||(i=t.createBin("Image Generation"));r.importFiles([e],!1,i,!1);var o=i.children[i.children.numItems-1],s=r.activeSequence,c=s.getPlayerPosition(),u=c.seconds+5,l=null;for(n=0;n<s.videoTracks.numTracks;n++){var p=s.videoTracks[n];if($._MYFUNCTIONS.isTrackClearAtTime(p,c.seconds,u)){l=p;break}}if(l){var m=l.overwriteClip(o,c.seconds);if(m){var f=new Time;return f.seconds=c.seconds+5,m.end=f,m}}},$._MYFUNCTIONS.exportAudioFromSelectionDirect=function(e){app.enableQE();var r=app.project.activeSequence,t=qe.project.getActiveSequence(),i=r.audioTracks,n=i.numTracks,a=new Date,o=a.getFullYear()+"_"+("0"+(a.getMonth()+1)).slice(-2)+"_"+("0"+a.getDate()).slice(-2)+"_"+("0"+a.getHours()).slice(-2)+"_"+("0"+a.getMinutes()).slice(-2)+"_"+("0"+a.getSeconds()).slice(-2),s=Folder(Folder.myDocuments.fullName+"/Adobe/Premiere Pro/Premiere Copilot/audio_sync/"+o);s.exists||s.create();for(var c=0;c<n;c++){for(var u=i[c],l=t.getAudioTrackAt(c),p=0;p<n;p++)i[p].setMute(p===c?0:1);for(var m=0;m<u.clips.numItems;m++){var f=u.clips[m];if(f.isSelected())if(l.getItemAt(m)){r.setInPoint(f.start.seconds),r.setOutPoint(f.end.seconds);var d="track"+c+"_"+f.name.replace(/[^\w\-]/g,"_"),v=s.fsName+"/"+d+".wav";r.exportAsMediaDirect(v,e,1)}}}for(var T=0;T<n;T++)i[T].setMute(0);return s.fsName},$._MYFUNCTIONS.addMarkersFromAnnotations=function(e){for(var r=app.project.activeSequence.markers,t=0;t<e.length;t++){var i=e[t],n=i.time_start,a=i.comment,o=r.createMarker(n);o.name="Annotation "+(t+1),o.comments=a,o.setTypeAsComment()}},$._MYFUNCTIONS.getProjectArchitectureAsString=function(){if(!app.project)return"ERREUR : Aucun projet n'est ouvert dans Premiere Pro.";var e=app.project,r=[],t=["wav","mp3","aac","aif","aiff","m4a"],i=["jpg","jpeg","png","psd","gif","bmp","tiff"],n="‚úÇÔ∏è",a="üé•",o="üéµ",s="üèûÔ∏è",c="üìÇ",u="‚ùì";function l(e){var r=e.getMediaPath();if(!r)return a;var n=r.split(".").pop().toLowerCase();return t.indexOf(n)>-1?o:i.indexOf(n)>-1?s:a}return r.push("Structure du Projet : "+e.name),r.push("======================================="),function e(t,i){for(var a=t.children,o=0;o<a.numItems;o++){var s=a[o],p=s.name,m="";if(s.type===ProjectItemType.BIN)m=i+c+" "+p,r.push(m),e(s,i+"  ‚îÇ ");else if(s.isSequence&&s.isSequence())m=i+n+" "+p,r.push(m);else if(s.type===ProjectItemType.CLIP||s.type===ProjectItemType.FILE){m=i+l(s)+" "+p,r.push(m)}else m=i+u+" "+p+" (Type: "+s.type+")",r.push(m)}}(e.rootItem,""),r.join("\n")},$._MYFUNCTIONS.exportAudioJumpCuts=function(){var e=Folder.myDocuments.fsName,r=new Folder(e+"/Adobe/Premiere Pro/Premiere Copilot/temp"),t=app.project.activeSequence,i=$.os.toLowerCase();var n,a,o=(n=new Date,a=function(e){return(e<10?"0":"")+e},n.getFullYear().toString()+a(n.getMonth()+1)+a(n.getDate())+"_"+a(n.getHours())+a(n.getMinutes())+a(n.getSeconds()));if(-1!==i.indexOf("mac"))var s="/Library/Application Support/Adobe/CEP/extensions/PremiereGPTBeta/js/libs/render/Audio_ForJumpCuts.epr",c=r.fsName+"/"+t.name+"_"+o+".wav";else if(-1!==i.indexOf("windows")){s=new File("C:/Program Files/Common Files/Adobe/CEP/extensions/PremiereGPTBeta/js/libs/render/Audio_ForJumpCuts.epr").fsName;c=File(r.absoluteURI+"/"+t.name+"_"+o+".wav").fsName}return t.exportAsMediaDirect(c,s,1)?($.writeln("Export audio r√©ussi vers : "+c),c):(alert("Erreur lors de l'export audio de la s√©quence : "+t.name),null)},$._MYFUNCTIONS.getOffsetJumpCuts=function(){try{var e=app.project.activeSequence;return e?e.getPlayerPosition().seconds:(alert("No active sequence."),null)}catch(e){return alert("An error occurred : "+e.toString()),null}},$._MYFUNCTIONS.disableSegmentsInRange=function(e){e=JSON.parse(e),app.enableQE();for(var r=qe.project.getActiveSequence(),t=app.project.activeSequence,i=254016e6,n=[],a=0;a<e.length;a++){var o=e[a][0],s=Math.floor(o*i);(v=new Time).ticks=s.toString(),t.setPlayerPosition(v.ticks);for(var c=parseInt(v.ticks),u=0;u<r.numVideoTracks;u++){(T=r.getVideoTrackAt(u))&&T.razor(r.CTI.timecode)}for(var l=0;l<r.numAudioTracks;l++){(T=r.getAudioTrackAt(l))&&T.razor(r.CTI.timecode)}for(l=0;l<t.videoTracks.numTracks;l++){if((T=t.videoTracks[l])&&T.clips.numItems>0)for(var p=T.clips.numItems-1;p>=0;p--){var m=T.clips[p],f=(d=parseInt(m.start.ticks))+parseInt(m.duration.ticks);if(d<=c&&c<f){n.push(m);break}}}for(l=0;l<t.audioTracks.numTracks;l++){if((T=t.audioTracks[l])&&T.clips.numItems>0)for(p=T.clips.numItems-1;p>=0;p--){var d;m=T.clips[p],f=(d=parseInt(m.start.ticks))+parseInt(m.duration.ticks);if(d<=c&&c<f){n.push(m);break}}}var v;o=e[a][1],s=Math.floor(o*i);(v=new Time).ticks=s.toString(),t.setPlayerPosition(v.ticks);for(c=parseInt(v.ticks),u=0;u<r.numVideoTracks;u++){(T=r.getVideoTrackAt(u))&&T.razor(r.CTI.timecode)}for(l=0;l<r.numAudioTracks;l++){var T;(T=r.getAudioTrackAt(l))&&T.razor(r.CTI.timecode)}}for(l=0;l<n.length;l++){(m=n[l]).disabled=1}},$._MYFUNCTIONS.supprimerClipsDesactives=function(){for(var e=app.project.activeSequence,r=[],t=0;t<e.videoTracks.numTracks;t++)for(var i=e.videoTracks[t],n=0;n<i.clips.numItems;n++){(o=i.clips[n]).disabled&&r.push(o)}for(t=0;t<e.audioTracks.numTracks;t++){var a=e.audioTracks[t];for(n=0;n<a.clips.numItems;n++){var o;(o=a.clips[n]).disabled&&r.push(o)}}if(0!==r.length){r.sort(function(e,r){return r.start.seconds-e.start.seconds});for(t=0;t<r.length;t++)r[t].remove(!0,!1);alert("Operation finished ‚ú®\n"+r.length+" clips have been deleted. üóëÔ∏è")}else alert("No disabled clips found.")},$._MYFUNCTIONS.deleteFile=function(e){var r=new File(e);return r.exists?(r.remove(),"File "+e+" deleted."):"File "+e+" not found."};